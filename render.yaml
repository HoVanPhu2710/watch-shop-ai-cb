services:
  # Rasa Server (Main API)
  # Note: Python version is specified in runtime.txt (python-3.10)
  - type: web
    name: rasa-server
    env: python
    buildCommand: pip install --upgrade pip && pip install "setuptools<70" wheel && pip install --no-cache-dir -r requirements.txt
    startCommand: rasa run --enable-api --cors "*" --port $PORT --model models
    envVars:
      - key: PORT
        value: 5005
      - key: API_URL
        value: https://watch-shop-uzr4.onrender.com
      - key: PYTHON_VERSION
        value: 3.10.12
    healthCheckPath: /status

  # Rasa Action Server
  - type: web
    name: rasa-actions
    env: python
    buildCommand: pip install --upgrade pip && pip install "setuptools<70" wheel && pip install --no-cache-dir -r requirements.txt
    startCommand: rasa run actions --port $PORT
    envVars:
      - key: PORT
        value: 5055
      - key: API_URL
        value: https://watch-shop-uzr4.onrender.com
      - key: PYTHON_VERSION
        value: 3.10.12
